{"version":3,"file":"maplibre-gl-indoorequal.umd.min.js","sources":["../src/level_control.js","../src/layers.js","../src/image.js","../src/sprite.js","../src/index.js","../node_modules/debounce/index.js","../src/levels.js","../node_modules/array-equal/index.js"],"sourcesContent":["export default class LevelControl {\n  constructor(indoorequal) {\n    this.indoorequal = indoorequal;\n    this._cbRefresh = () => this._refresh();\n    this.indoorequal.on('levelschange', this._cbRefresh);\n    this.indoorequal.on('levelchange', this._cbRefresh);\n\n    this.$el = document.createElement('div');\n    this.$el.classList.add('maplibregl-ctrl', 'maplibregl-ctrl-group', 'maplibregl-ctrl-indoorequal');\n    this._refresh();\n  }\n\n  destroy() {\n    this.$el.remove();\n    this.indoorequal.off('levelschange', this._cbRefresh);\n    this.indoorequal.off('levelchange', this._cbRefresh);\n  }\n\n  _refresh() {\n    this.$el.innerHTML = '';\n    this.indoorequal.levels.forEach((level) => {\n      const button = document.createElement('button');\n      const strong = document.createElement('strong');\n      strong.textContent = level;\n      button.appendChild(strong);\n      if (level == this.indoorequal.level) {\n        button.classList.add('maplibregl-ctrl-active');\n      }\n      button.addEventListener('click', () => {  this.indoorequal.setLevel(level); })\n      this.$el.appendChild(button);\n    });\n  }\n}\n","const commonPoi = {\n  \"type\": \"symbol\",\n  \"source-layer\": \"poi\",\n  \"layout\": {\n    \"icon-image\": [\n      \"coalesce\",\n      [\n        \"image\",\n        [\n          \"concat\",\n          [\n            \"literal\",\n            \"indoorequal-\"\n          ],\n          [\n            \"get\",\n            \"subclass\"\n          ]\n        ],\n      ],\n      [\n        \"image\",\n        [\n          \"concat\",\n          [\n            \"literal\",\n            \"indoorequal-\"\n          ],\n          [\n            \"get\",\n            \"class\"\n          ]\n        ]\n      ]\n    ],\n    \"text-anchor\": \"top\",\n    \"text-field\": [\n      \"case\",\n      // aeroway=gate\n      [\"==\", [\"get\", \"class\"], \"aeroway\"],\n      [\"get\", \"ref\"],\n      // default\n      [\"concat\",\n       [\"get\", \"name:latin\"],\n       \"\\n\",\n       [\"get\", \"name:nonlatin\"]\n      ],\n    ],\n    \"text-max-width\": 9,\n    \"text-offset\": [\n      0,\n      0.6\n    ],\n    \"text-padding\": 2,\n    \"text-size\": 12\n  },\n  \"paint\": {\n    \"text-color\": \"#666\",\n    \"text-halo-blur\": 0.5,\n    \"text-halo-color\": \"#ffffff\",\n    \"text-halo-width\": 1\n  }\n};\n\nconst rank2Class = [\"waste_basket\", \"information\", \"vending_machine\", \"bench\", \"photo_booth\", \"ticket_validator\"];\n\nexport const layers = [\n  {\n    id: \"indoor-polygon\",\n    type: \"fill\",\n    \"source-layer\": \"area\",\n    filter: [\n      \"all\",\n      [\n        \"==\",\n        \"$type\",\n        \"Polygon\"\n      ],\n      [\n        \"!=\",\n        \"class\",\n        \"level\"\n      ]\n    ],\n    paint: {\n      \"fill-color\": [\n        \"case\",\n        // if private\n        [\"all\", [\"has\", \"access\"], [\"in\", [\"get\", \"access\"], [\"literal\", [\"no\", \"private\"]]]],\n        \"#F2F1F0\",\n        // if POI\n        [\"any\",\n         [\"all\", [\"==\", [\"get\", \"is_poi\"], true], [\"!=\", [\"get\", \"class\"], \"corridor\"]],\n         [\n           \"in\",\n           [\"get\", \"subclass\"],\n           [\"literal\", [\"class\", \"laboratory\", \"office\", \"auditorium\", \"amphitheatre\", \"reception\"]]]\n        ],\n        \"#D4EDFF\",\n        // if is a room\n        [\"==\", [\"get\", \"class\"], \"room\"],\n        \"#fefee2\",\n        // default\n        \"#fdfcfa\"\n      ]\n    }\n  },\n  {\n    id: \"indoor-area\",\n    \"type\": \"line\",\n    \"source-layer\": \"area\",\n    \"filter\": [\n      \"all\",\n      [\n        \"in\",\n        \"class\",\n        \"area\",\n        \"corridor\",\n        \"platform\"\n      ]\n    ],\n    \"paint\": {\n      \"line-color\": \"#bfbfbf\",\n      \"line-width\": 1\n    }\n  },\n  {\n    id: \"indoor-column\",\n    \"type\": \"fill\",\n    \"source-layer\": \"area\",\n    \"filter\": [\n      \"all\",\n      [\n        \"==\",\n        \"class\",\n        \"column\"\n      ]\n    ],\n    \"paint\": {\n      \"fill-color\": \"#bfbfbf\"\n    }\n  },\n  {\n    id: \"indoor-lines\",\n    \"type\": \"line\",\n    \"source-layer\": \"area\",\n    \"filter\": [\n      \"all\",\n      [\n        \"in\",\n        \"class\",\n        \"room\",\n        \"wall\"\n      ]\n    ],\n    \"paint\": {\n      \"line-color\": \"gray\",\n      \"line-width\": 2\n    }\n  },\n  {\n    id: \"indoor-transportation\",\n    \"type\": \"line\",\n    \"source-layer\": \"transportation\",\n    \"filter\": [\n      \"all\"\n    ],\n    \"paint\": {\n      \"line-color\": \"gray\",\n      \"line-dasharray\": [\n        0.4,\n        0.75\n      ],\n      \"line-width\": {\n        \"base\": 1.4,\n        \"stops\": [\n          [\n            17,\n            2\n          ],\n          [\n            20,\n            10\n          ]\n        ]\n      }\n    }\n  },\n  {\n    id: \"indoor-transportation-poi\",\n    \"type\": \"symbol\",\n    \"source-layer\": \"transportation\",\n    \"filter\": [\n      \"all\",\n      [\n        \"in\",\n        \"$type\",\n        \"Point\",\n        \"LineString\"\n      ],\n      [\n        \"in\",\n        \"class\",\n        \"steps\",\n        \"elevator\",\n        \"escalator\"\n      ]\n    ],\n    \"layout\": {\n      \"icon-image\": [\n        \"case\",\n        [\n          \"has\",\n          \"conveying\"\n        ],\n        \"indoorequal-escalator\",\n        [\n          \"concat\",\n          [\n            \"literal\",\n            \"indoorequal-\"\n          ],\n          [\n            \"get\",\n            \"class\"\n          ]\n        ]\n      ],\n      \"symbol-placement\": \"line-center\",\n      \"icon-rotation-alignment\": \"viewport\"\n    }\n  },\n  {\n    id: \"indoor-poi-rank1\",\n    ...commonPoi,\n    \"filter\": [\n      \"all\",\n      [\n        \"==\",\n        \"$type\",\n        \"Point\"\n      ],\n      [\n        \"!in\",\n        \"class\",\n        ...rank2Class\n      ]\n    ]\n  },\n  {\n    id: \"indoor-poi-rank2\",\n    ...commonPoi,\n    minzoom: 19,\n    \"filter\": [\n      \"all\",\n      [\n        \"==\",\n        \"$type\",\n        \"Point\"\n      ],\n      [\n        \"in\",\n        \"class\",\n        ...rank2Class\n      ]\n    ]\n  },\n  {\n    id: \"indoor-heat\",\n    \"type\": \"heatmap\",\n    \"source-layer\": \"heat\",\n    \"filter\": [ \"all\" ],\n    \"paint\": {\n      \"heatmap-color\": [\"interpolate\", [\"linear\"], [\"heatmap-density\"],\n        0, \"rgba(102, 103, 173, 0)\",\n        0.1, \"rgba(102, 103, 173, 0.2)\",\n        1, \"rgba(102, 103, 173, 0.7)\"\n      ],\n      \"heatmap-radius\": [\n        \"interpolate\", [\"linear\"], [\"zoom\"],\n        0, 3,\n        13, 20,\n        17, 40\n      ],\n      \"heatmap-intensity\": 1,\n      \"heatmap-opacity\": [\n        \"interpolate\", [\"linear\"], [\"zoom\"],\n        16, 1,\n        17.1, 0\n      ]\n    }\n  },\n  {\n    id: \"indoor-name\",\n    \"type\": \"symbol\",\n    \"source-layer\": \"area_name\",\n    \"filter\": [\n      \"all\"\n    ],\n    \"layout\": {\n      \"text-field\": [\n        \"concat\",\n        [\"coalesce\",\n         [\"get\", \"name:latin\"],\n         [\"get\", \"ref\"],\n        ],\n        \"\\n\",\n        [\"get\", \"name:nonlatin\"],\n      ],\n      \"text-max-width\": 5,\n      \"text-size\": 14\n    },\n    \"paint\": {\n      \"text-color\": \"#666\",\n      \"text-halo-color\": \"#ffffff\",\n      \"text-halo-width\": 1\n    }\n  }\n];\n","function createImage(image, {width, height}, channels, data) {\n    if (!data) {\n        data = new Uint8Array(width * height * channels);\n    } else if (data instanceof Uint8ClampedArray) {\n        data = new Uint8Array(data.buffer);\n    } else if (data.length !== width * height * channels) {\n        throw new RangeError('mismatched image size');\n    }\n    image.width = width;\n    image.height = height;\n    image.data = data;\n    return image;\n}\n\nfunction resizeImage(image, {width, height}, channels) {\n    if (width === image.width && height === image.height) {\n        return;\n    }\n\n    const newImage = createImage({}, {width, height}, channels);\n\n    copyImage(image, newImage, {x: 0, y: 0}, {x: 0, y: 0}, {\n        width: Math.min(image.width, width),\n        height: Math.min(image.height, height)\n    }, channels);\n\n    image.width = width;\n    image.height = height;\n    image.data = newImage.data;\n}\n\nfunction copyImage(srcImg, dstImg, srcPt, dstPt, size, channels) {\n    if (size.width === 0 || size.height === 0) {\n        return dstImg;\n    }\n\n    if (size.width > srcImg.width ||\n        size.height > srcImg.height ||\n        srcPt.x > srcImg.width - size.width ||\n        srcPt.y > srcImg.height - size.height) {\n        throw new RangeError('out of range source coordinates for image copy');\n    }\n\n    if (size.width > dstImg.width ||\n        size.height > dstImg.height ||\n        dstPt.x > dstImg.width - size.width ||\n        dstPt.y > dstImg.height - size.height) {\n        throw new RangeError('out of range destination coordinates for image copy');\n    }\n\n    const srcData = srcImg.data;\n    const dstData = dstImg.data;\n\n    for (let y = 0; y < size.height; y++) {\n        const srcOffset = ((srcPt.y + y) * srcImg.width + srcPt.x) * channels;\n        const dstOffset = ((dstPt.y + y) * dstImg.width + dstPt.x) * channels;\n        for (let i = 0; i < size.width * channels; i++) {\n            dstData[dstOffset + i] = srcData[srcOffset + i];\n        }\n    }\n    return dstImg;\n}\n\n// Not premultiplied, because ImageData is not premultiplied.\n// UNPACK_PREMULTIPLY_ALPHA_WEBGL must be used when uploading to a texture.\nexport class RGBAImage {\n    constructor(size, data) {\n        createImage(this, size, 4, data);\n    }\n\n    resize(size) {\n        resizeImage(this, size, 4);\n    }\n\n    replace(data, copy) {\n        if (copy) {\n            this.data.set(data);\n        } else if (data instanceof Uint8ClampedArray) {\n            this.data = new Uint8Array(data.buffer);\n        } else {\n            this.data = data;\n        }\n    }\n\n    clone() {\n        return new RGBAImage({width: this.width, height: this.height}, new Uint8Array(this.data));\n    }\n\n    static copy(srcImg, dstImg, srcPt, dstPt, size) {\n        copyImage(srcImg, dstImg, srcPt, dstPt, size, 4);\n    }\n}\n","import {RGBAImage} from './image.js';\n\nfunction getImageData(img, padding) {\n  const canvas = window.document.createElement('canvas');\n  const context = canvas.getContext('2d');\n  if (!context) {\n    throw new Error('failed to create canvas 2d context');\n  }\n  canvas.width = img.width;\n  canvas.height = img.height;\n  context.drawImage(img, 0, 0, img.width, img.height);\n  return context.getImageData(0, 0, img.width, img.height);\n}\n\nexport default function(baseUrl) {\n  const format = window.devicePixelRatio > 1 ? '@2x' : '';\n  let json, image;\n\n  const jsonRequest = fetch(`${baseUrl}${format}.json`)\n        .then(r => r.json())\n        .then(r => json = r)\n\n  const imageRequest = fetch(`${baseUrl}${format}.png`)\n        .then(r => r.blob())\n        .then(r => {\n          image = new Image();\n          image.src = URL.createObjectURL(r);\n          return new Promise((resolve, reject) => {\n            image.onload = () => resolve();\n            image.onerror = () => reject();\n          });\n        });\n\n  return Promise.all([jsonRequest, imageRequest])\n    .then(() => {\n      const imageData = getImageData(image);\n      const result = {};\n\n      for (const id in json) {\n        const {width, height, x, y, sdf, pixelRatio, stretchX, stretchY, content} = json[id];\n        const data = new RGBAImage({width, height});\n        RGBAImage.copy(imageData, data, {x, y}, {x: 0, y: 0}, {width, height});\n        result[id] = {data, pixelRatio, sdf, stretchX, stretchY, content};\n      }\n      return result;\n    });\n}\n","import debounce from 'debounce';\nimport arrayEqual from 'array-equal';\nimport findAllLevels from './levels.js';\nimport LevelControl from './level_control.js';\nimport { layers } from './layers.js';\nimport loadSprite from './sprite.js';\n\nclass GeoJSONSource {\n  constructor(map, options = {}) {\n    const defaultOpts = { layers, geojson: {} };\n    const opts = { ...defaultOpts, ...options };\n    this.map = map;\n    this.geojson = opts.geojson;\n    this.layers = opts.layers;\n    this.baseSourceId = 'indoorequal';\n    this.sourceId = `${this.baseSourceId}_area`;\n  }\n\n  addSource() {\n    Object.keys(this.geojson).forEach((layerName) => {\n      this.map.addSource(`${this.baseSourceId}_${layerName}`, {\n        type: 'geojson',\n        data: this.geojson[layerName]\n      });\n    });\n  }\n\n  addLayers() {\n    const sourceLayers = Object.keys(this.geojson);\n    const layers = this.layers;\n    this.layers = layers.filter((layer) => {\n      return sourceLayers.includes(layer['source-layer']);\n    });\n    this.layers.forEach((layer) => {\n      this.map.addLayer({\n        source: `${this.baseSourceId}_${layer['source-layer']}`,\n        ...layer,\n        'source-layer': ''\n      });\n    });\n  }\n\n  remove() {\n    this.layers.forEach((layer) => {\n      this.map.removeLayer(layer.id);\n    });\n    Object.keys(this.geojson).forEach((layerName) => {\n      this.map.removeSource(`${this.baseSourceId}_${layerName}`);\n    });\n  }\n}\n\nclass VectorTileSource {\n  constructor(map, options = {}) {\n    const defaultOpts = { url: 'https://tiles.indoorequal.org/', layers };\n    const opts = { ...defaultOpts, ...options };\n    if (opts.url === defaultOpts.url && !opts.apiKey) {\n      throw 'You must register your apiKey at https://indoorequal.com before and set it as apiKey param.';\n    }\n    this.map = map;\n    this.url = opts.url;\n    this.apiKey = opts.apiKey;\n    this.layers = opts.layers;\n    this.sourceId = 'indoorequal';\n  }\n\n  addSource() {\n    const queryParams = this.apiKey ? `?key=${this.apiKey}` : '';\n    this.map.addSource(this.sourceId, {\n      type: 'vector',\n      url: `${this.url}${queryParams}`\n    });\n  }\n\n  addLayers() {\n    this.layers.forEach((layer) => {\n      this.map.addLayer({\n        source: this.sourceId,\n        ...layer\n      });\n    });\n  }\n\n  remove() {\n    this.layers.forEach((layer) => {\n      this.map.removeLayer(layer.id);\n    });\n    this.map.removeSource(this.sourceId);\n  }\n}\n\n/**\n * Load the indoor= source and layers in your map.\n * @param {object} map the maplibre-gl instance of the map\n * @param {object} options\n * @param {string} [options.url] Override the default tiles URL (https://tiles.indoorequal.org/).\n * @param {object} [options.geojson] GeoJSON data with with key as layer name and value with geojson features\n * @param {string} [options.apiKey] The API key if you use the default tile URL (get your free key at [indoorequal.com](https://indoorequal.com)).\n * @param {array} [options.layers] The layers to be used to style indoor= tiles. Take a look a the [layers.js file](https://github.com/indoorequal/maplibre-gl-indoorequal/blob/master/src/layers.js) file and the [vector schema](https://indoorequal.com/schema)\n * @param {boolean} [options.heatmap] Should the heatmap layer be visible at start (true : visible, false : hidden). Defaults to true/visible.\n * @property {string} level The current level displayed\n * @property {array} levels  The levels that can be displayed in the current view\n * @fires IndoorEqual#levelschange\n * @fires IndoorEqual#levelchange\n * @return {IndoorEqual} `this`\n */\nexport default class IndoorEqual {\n  constructor(map, options = {}) {\n    const SourceKlass = options.geojson ? GeoJSONSource : VectorTileSource;\n    const defaultOpts = { heatmap: true };\n    const opts = { ...defaultOpts, ...options };\n    this.source = new SourceKlass(map, options);\n    this.map = map;\n    this.levels = [];\n    this.level = '0';\n    this.events = {};\n    this._loadSprite = loadSprite;\n\n    if (this.map.isStyleLoaded()) {\n      this._init();\n      this.setHeatmapVisible(opts.heatmap);\n    } else {\n      this.map.once('load', () => {\n        this._init();\n        this.setHeatmapVisible(opts.heatmap);\n      });\n    }\n  }\n\n  /**\n   * Remove any layers, source and listeners and controls\n   */\n  remove(fromRemoveEvent) {\n    if (!fromRemoveEvent) {\n      this.source.remove();\n    }\n    this._updateLevelsDebounce.clear();\n    this.map.off('load', this._updateLevelsDebounce);\n    this.map.off('data', this._updateLevelsDebounce);\n    this.map.off('move', this._updateLevelsDebounce);\n    if (this._control) {\n      this.onRemove();\n    }\n  }\n\n  /**\n   * Add an event listener\n   * @param {string} name the name of the event\n   * @param {function} fn the function to be called when the event is emitted\n   */\n  on(name, fn) {\n    if (!this.events[name]) {\n      this.events[name] = [];\n    }\n    this.events[name].push(fn);\n  }\n\n  /**\n   * Remove an event listener.\n   * @param {string} name the name of the event\n   * @param {function} fn the same function when on() was called\n   */\n  off(name, fn) {\n    if (!this.events[name]) {\n      this.events[name] = [];\n    }\n    this.events[name] = this.events[name].filter(cb => cb !== fn);\n  }\n\n  /**\n   * Add the level control to the map\n   * Used when adding the control via the map instance: map.addControl(indoorEqual)\n   */\n  onAdd() {\n    this._control = new LevelControl(this);\n    return this._control.$el;\n  }\n\n  /**\n   * Remove the level control\n   * Used when removing the control via the map instance: map.removeControl(indoorEqual)\n   */\n  onRemove() {\n    this._control.destroy();\n    this._control = null;\n  }\n\n  /**\n   * Set the displayed level.\n   * @param {string} level the level to be displayed\n   * @fires IndoorEqual#levelchange\n   */\n  setLevel(level) {\n    this.level = level;\n    this._updateFilters();\n    this._emitLevelChange();\n  }\n\n  /**\n   * Set the displayed level.\n   * @deprecated Use setLevel instead\n   * @param {string} level the level to be displayed\n   * @fires IndoorEqual#levelchange\n   */\n  updateLevel(level) {\n    console.log('The updateLevel method is deprecated. Please use setLevel instead.');\n    this.setLevel(level);\n  }\n\n  /**\n   * Load a sprite and add all images to the map\n   * @param {string} baseUrl the baseUrl where to load the sprite\n   * @param {object} options\n   * @param {boolean} [options.update] Update existing image (default false)\n   * @return {Promise} It resolves an hash of images.\n   */\n  loadSprite(baseUrl, options = {}) {\n    const opts = { update: false, ...options };\n    return this._loadSprite(baseUrl)\n      .then((sprite) => {\n        for (const id in sprite) {\n          const { data, ...options } = sprite[id];\n          if (!this.map.hasImage(id)) {\n            this.map.addImage(id, data, options);\n          } else if (opts.update) {\n            this.map.updateImage(id, data);\n          }\n        }\n        return sprite;\n      });\n  }\n\n  /**\n   * Change the heatmap layer visibility\n   * @param {boolean} visible True to make it visible, false to hide it\n   */\n  setHeatmapVisible(visible) {\n    if (this.map.getLayer('indoor-heat')) {\n      this.map.setLayoutProperty('indoor-heat', 'visibility', visible ? 'visible' : 'none');\n    }\n  }\n\n  _init() {\n    this.source.addSource();\n    this.source.addLayers();\n    this._updateFilters();\n    this._updateLevelsDebounce = debounce(this._updateLevels.bind(this), 1000);\n\n    this.map.on('load', this._updateLevelsDebounce);\n    this.map.on('data', this._updateLevelsDebounce);\n    this.map.on('move', this._updateLevelsDebounce);\n    this.map.on('remove', () => {\n      this.remove(true);\n    });\n  }\n\n  _updateFilters() {\n    this.source.layers\n    .filter(layer => layer.type !== 'heatmap')\n    .forEach((layer) => {\n      this.map.setFilter(layer.id, [ ...layer.filter || ['all'], ['==', 'level', this.level]]);\n    });\n  }\n\n  _refreshAfterLevelsUpdate() {\n    if (!this.levels.includes(this.level)) {\n      this.setLevel('0');\n    }\n  }\n\n  _updateLevels() {\n    if (this.map.isSourceLoaded(this.source.sourceId)) {\n      const features = this.map.querySourceFeatures(this.source.sourceId, { sourceLayer: 'area' });\n      const levels = findAllLevels(features);\n      if (!arrayEqual(levels, this.levels)) {\n        this.levels = levels;\n        this._emitLevelsChange();\n        this._refreshAfterLevelsUpdate();\n      }\n    }\n  }\n\n  _emitLevelsChange() {\n    this._emitEvent('levelschange', this.levels);\n  }\n\n  _emitLevelChange() {\n    this._emitEvent('levelchange', this.level);\n  }\n\n  _emitEvent(eventName, ...args) {\n    (this.events[eventName] || []).forEach(fn => fn(...args));\n  }\n}\n\n/**\n * Emitted when the list of available levels has been updated\n *\n * @event IndoorEqual#levelschange\n * @type {array}\n */\n\n/**\n * Emitted when the current level has been updated\n *\n * @event IndoorEqual#levelchange\n * @type {string} always emitted when the level displayed has changed\n */\n","export default function debounce(function_, wait = 100, options = {}) {\n\tif (typeof function_ !== 'function') {\n\t\tthrow new TypeError(`Expected the first parameter to be a function, got \\`${typeof function_}\\`.`);\n\t}\n\n\tif (wait < 0) {\n\t\tthrow new RangeError('`wait` must not be negative.');\n\t}\n\n\tif (typeof options === 'boolean') {\n\t\tthrow new TypeError('The `options` parameter must be an object, not a boolean. Use `{immediate: true}` instead.');\n\t}\n\n\tconst {immediate} = options;\n\n\tlet storedContext;\n\tlet storedArguments;\n\tlet timeoutId;\n\tlet timestamp;\n\tlet result;\n\n\tfunction run() {\n\t\tconst callContext = storedContext;\n\t\tconst callArguments = storedArguments;\n\t\tstoredContext = undefined;\n\t\tstoredArguments = undefined;\n\t\tresult = function_.apply(callContext, callArguments);\n\t\treturn result;\n\t}\n\n\tfunction later() {\n\t\tconst last = Date.now() - timestamp;\n\n\t\tif (last < wait && last >= 0) {\n\t\t\ttimeoutId = setTimeout(later, wait - last);\n\t\t} else {\n\t\t\ttimeoutId = undefined;\n\n\t\t\tif (!immediate) {\n\t\t\t\tresult = run();\n\t\t\t}\n\t\t}\n\t}\n\n\tconst debounced = function (...arguments_) {\n\t\tif (\n\t\t\tstoredContext\n\t\t\t&& this !== storedContext\n\t\t\t&& Object.getPrototypeOf(this) === Object.getPrototypeOf(storedContext)\n\t\t) {\n\t\t\tthrow new Error('Debounced method called with different contexts of the same prototype.');\n\t\t}\n\n\t\tstoredContext = this; // eslint-disable-line unicorn/no-this-assignment\n\t\tstoredArguments = arguments_;\n\t\ttimestamp = Date.now();\n\n\t\tconst callNow = immediate && !timeoutId;\n\n\t\tif (!timeoutId) {\n\t\t\ttimeoutId = setTimeout(later, wait);\n\t\t}\n\n\t\tif (callNow) {\n\t\t\tresult = run();\n\t\t\treturn result;\n\t\t}\n\n\t\treturn undefined;\n\t};\n\n\tObject.defineProperty(debounced, 'isPending', {\n\t\tget() {\n\t\t\treturn timeoutId !== undefined;\n\t\t},\n\t});\n\n\tdebounced.clear = () => {\n\t\tif (!timeoutId) {\n\t\t\treturn;\n\t\t}\n\n\t\tclearTimeout(timeoutId);\n\t\ttimeoutId = undefined;\n\t\tstoredContext = undefined;\n\t\tstoredArguments = undefined;\n\t};\n\n\tdebounced.flush = () => {\n\t\tif (!timeoutId) {\n\t\t\treturn;\n\t\t}\n\n\t\tdebounced.trigger();\n\t};\n\n\tdebounced.trigger = () => {\n\t\tresult = run();\n\n\t\tdebounced.clear();\n\t};\n\n\treturn debounced;\n}\n","export default function findAllLevels(features) {\n  const levels = [];\n  for (let i = 0; i < features.length; i++) {\n    const feature = features[i];\n    if (feature.properties.class === 'level') {\n      continue;\n    }\n    const level = feature.properties.level;\n    if (!levels.includes(level)) {\n      levels.push(level);\n    }\n  }\n  return levels.sort((a, b) => a - b).reverse();\n}\n","export default function arrayEqual(array1, array2) {\n\tif (array1 === array2) {\n\t\treturn true;\n\t}\n\n\tconst {length} = array1;\n\n\tif (length !== array2.length) {\n\t\treturn false;\n\t}\n\n\tfor (let index = 0; index < length; index++) {\n\t\tif (array1[index] !== array2[index]) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n"],"names":["LevelControl","_createClass","indoorequal","_this","this","_classCallCheck","_cbRefresh","_refresh","on","$el","document","createElement","classList","add","key","value","remove","off","_this2","innerHTML","levels","forEach","level","button","strong","textContent","appendChild","addEventListener","setLevel","commonPoi","type","layout","paint","rank2Class","layers","id","filter","base","stops","_objectSpread","concat","minzoom","createImage","image","_ref","channels","data","width","height","Uint8ClampedArray","Uint8Array","buffer","length","RangeError","copyImage","srcImg","dstImg","srcPt","dstPt","size","x","y","srcData","dstData","srcOffset","dstOffset","i","RGBAImage","_ref2","newImage","Math","min","resizeImage","copy","set","loadSprite","baseUrl","json","format","window","devicePixelRatio","jsonRequest","fetch","then","r","imageRequest","blob","Image","src","URL","createObjectURL","Promise","resolve","reject","onload","onerror","all","imageData","img","canvas","context","getContext","Error","drawImage","getImageData","result","_json$id","sdf","pixelRatio","stretchX","stretchY","content","GeoJSONSource","map","options","arguments","undefined","opts","geojson","baseSourceId","sourceId","Object","keys","layerName","addSource","sourceLayers","layer","includes","addLayer","source","_this3","removeLayer","removeSource","VectorTileSource","defaultOpts","url","apiKey","queryParams","_this4","_this5","IndoorEqual","_this6","SourceKlass","heatmap","events","_loadSprite","isStyleLoaded","_init","setHeatmapVisible","once","fromRemoveEvent","_updateLevelsDebounce","clear","_control","onRemove","name","fn","push","cb","destroy","_updateFilters","_emitLevelChange","console","log","_this7","update","sprite","_sprite$id","_objectWithoutProperties","_excluded","hasImage","updateImage","addImage","visible","getLayer","setLayoutProperty","_this8","addLayers","function_","wait","TypeError","immediate","storedContext","storedArguments","timeoutId","timestamp","run","callContext","callArguments","apply","later","last","Date","now","setTimeout","debounced","arguments_","getPrototypeOf","callNow","defineProperty","get","clearTimeout","flush","trigger","debounce","_updateLevels","bind","_this9","setFilter","_toConsumableArray","isSourceLoaded","features","feature","properties","sort","a","b","reverse","findAllLevels","querySourceFeatures","sourceLayer","array1","array2","index","arrayEqual","_emitLevelsChange","_refreshAfterLevelsUpdate","_emitEvent","eventName","_len","args","Array","_key"],"mappings":"woFAAqBA,EAAY,WAU9B,OAAAC,EATD,SAAAD,EAAYE,GAAa,IAAAC,EAAAC,KAAAC,OAAAL,GACvBI,KAAKF,YAAcA,EACnBE,KAAKE,WAAa,WAAA,OAAMH,EAAKI,UAAU,EACvCH,KAAKF,YAAYM,GAAG,eAAgBJ,KAAKE,YACzCF,KAAKF,YAAYM,GAAG,cAAeJ,KAAKE,YAExCF,KAAKK,IAAMC,SAASC,cAAc,OAClCP,KAAKK,IAAIG,UAAUC,IAAI,kBAAmB,wBAAyB,+BACnET,KAAKG,UACP,EAAC,CAAA,CAAAO,IAAA,UAAAC,MAED,WACEX,KAAKK,IAAIO,SACTZ,KAAKF,YAAYe,IAAI,eAAgBb,KAAKE,YAC1CF,KAAKF,YAAYe,IAAI,cAAeb,KAAKE,WAC3C,GAAC,CAAAQ,IAAA,WAAAC,MAED,WAAW,IAAAG,EAAAd,KACTA,KAAKK,IAAIU,UAAY,GACrBf,KAAKF,YAAYkB,OAAOC,QAAQ,SAACC,GAC/B,IAAMC,EAASb,SAASC,cAAc,UAChCa,EAASd,SAASC,cAAc,UACtCa,EAAOC,YAAcH,EACrBC,EAAOG,YAAYF,GACfF,GAASJ,EAAKhB,YAAYoB,OAC5BC,EAAOX,UAAUC,IAAI,0BAEvBU,EAAOI,iBAAiB,QAAS,WAAST,EAAKhB,YAAY0B,SAASN,EAAQ,GAC5EJ,EAAKT,IAAIiB,YAAYH,EACvB,EACF,IAAC,CA/B8B,GCA3BM,EAAY,CAChBC,KAAQ,SACR,eAAgB,MAChBC,OAAU,CACR,aAAc,CACZ,WACA,CACE,QACA,CACE,SACA,CACE,UACA,gBAEF,CACE,MACA,cAIN,CACE,QACA,CACE,SACA,CACE,UACA,gBAEF,CACE,MACA,YAKR,cAAe,MACf,aAAc,CACZ,OAEA,CAAC,KAAM,CAAC,MAAO,SAAU,WACzB,CAAC,MAAO,OAER,CAAC,SACA,CAAC,MAAO,cACR,KACA,CAAC,MAAO,mBAGX,iBAAkB,EAClB,cAAe,CACb,EACA,IAEF,eAAgB,EAChB,YAAa,IAEfC,MAAS,CACP,aAAc,OACd,iBAAkB,GAClB,kBAAmB,UACnB,kBAAmB,IAIjBC,EAAa,CAAC,eAAgB,cAAe,kBAAmB,QAAS,cAAe,oBAEjFC,EAAS,CACpB,CACEC,GAAI,iBACJL,KAAM,OACN,eAAgB,OAChBM,OAAQ,CACN,MACA,CACE,KACA,QACA,WAEF,CACE,KACA,QACA,UAGJJ,MAAO,CACL,aAAc,CACZ,OAEA,CAAC,MAAO,CAAC,MAAO,UAAW,CAAC,KAAM,CAAC,MAAO,UAAW,CAAC,UAAW,CAAC,KAAM,cACxE,UAEA,CAAC,MACA,CAAC,MAAO,CAAC,KAAM,CAAC,MAAO,WAAW,GAAO,CAAC,KAAM,CAAC,MAAO,SAAU,aAClE,CACE,KACA,CAAC,MAAO,YACR,CAAC,UAAW,CAAC,QAAS,aAAc,SAAU,aAAc,eAAgB,gBAE/E,UAEA,CAAC,KAAM,CAAC,MAAO,SAAU,QACzB,UAEA,aAIN,CACEG,GAAI,cACJL,KAAQ,OACR,eAAgB,OAChBM,OAAU,CACR,MACA,CACE,KACA,QACA,OACA,WACA,aAGJJ,MAAS,CACP,aAAc,UACd,aAAc,IAGlB,CACEG,GAAI,gBACJL,KAAQ,OACR,eAAgB,OAChBM,OAAU,CACR,MACA,CACE,KACA,QACA,WAGJJ,MAAS,CACP,aAAc,YAGlB,CACEG,GAAI,eACJL,KAAQ,OACR,eAAgB,OAChBM,OAAU,CACR,MACA,CACE,KACA,QACA,OACA,SAGJJ,MAAS,CACP,aAAc,OACd,aAAc,IAGlB,CACEG,GAAI,wBACJL,KAAQ,OACR,eAAgB,iBAChBM,OAAU,CACR,OAEFJ,MAAS,CACP,aAAc,OACd,iBAAkB,CAChB,GACA,KAEF,aAAc,CACZK,KAAQ,IACRC,MAAS,CACP,CACE,GACA,GAEF,CACE,GACA,QAMV,CACEH,GAAI,4BACJL,KAAQ,SACR,eAAgB,iBAChBM,OAAU,CACR,MACA,CACE,KACA,QACA,QACA,cAEF,CACE,KACA,QACA,QACA,WACA,cAGJL,OAAU,CACR,aAAc,CACZ,OACA,CACE,MACA,aAEF,wBACA,CACE,SACA,CACE,UACA,gBAEF,CACE,MACA,WAIN,mBAAoB,cACpB,0BAA2B,aAE9BQ,EAAAA,EAAA,CAECJ,GAAI,oBACDN,GAAS,GAAA,CACZO,OAAU,CACR,MACA,CACE,KACA,QACA,UAGA,MACA,SAAOI,OACJP,MAENM,EAAAA,EAAA,CAGDJ,GAAI,oBACDN,GAAS,GAAA,CACZY,QAAS,GACTL,OAAU,CACR,MACA,CACE,KACA,QACA,UAGA,KACA,SAAOI,OACJP,MAIT,CACEE,GAAI,cACJL,KAAQ,UACR,eAAgB,OAChBM,OAAU,CAAE,OACZJ,MAAS,CACP,gBAAiB,CAAC,cAAe,CAAC,UAAW,CAAC,mBAC5C,EAAG,yBACH,GAAK,2BACL,EAAG,4BAEL,iBAAkB,CAChB,cAAe,CAAC,UAAW,CAAC,QAC5B,EAAG,EACH,GAAI,GACJ,GAAI,IAEN,oBAAqB,EACrB,kBAAmB,CACjB,cAAe,CAAC,UAAW,CAAC,QAC5B,GAAI,EACJ,KAAM,KAIZ,CACEG,GAAI,cACJL,KAAQ,SACR,eAAgB,YAChBM,OAAU,CACR,OAEFL,OAAU,CACR,aAAc,CACZ,SACA,CAAC,WACA,CAAC,MAAO,cACR,CAAC,MAAO,QAET,KACA,CAAC,MAAO,kBAEV,iBAAkB,EAClB,YAAa,IAEfC,MAAS,CACP,aAAc,OACd,kBAAmB,UACnB,kBAAmB,KC3TzB,SAASU,EAAYC,EAAKC,EAAmBC,EAAUC,GAAM,IAAhCC,EAAKH,EAALG,MAAOC,EAAMJ,EAANI,OAChC,GAAKF,GAEE,GAAIA,aAAgBG,kBACvBH,EAAO,IAAII,WAAWJ,EAAKK,aACxB,GAAIL,EAAKM,SAAWL,EAAQC,EAASH,EACxC,MAAM,IAAIQ,WAAW,8BAJrBP,EAAO,IAAII,WAAWH,EAAQC,EAASH,GAS3C,OAHAF,EAAMI,MAAQA,EACdJ,EAAMK,OAASA,EACfL,EAAMG,KAAOA,EACNH,CACX,CAmBA,SAASW,EAAUC,EAAQC,EAAQC,EAAOC,EAAOC,EAAMd,GACnD,GAAmB,IAAfc,EAAKZ,OAA+B,IAAhBY,EAAKX,OACzB,OAAOQ,EAGX,GAAIG,EAAKZ,MAAQQ,EAAOR,OACpBY,EAAKX,OAASO,EAAOP,QACrBS,EAAMG,EAAIL,EAAOR,MAAQY,EAAKZ,OAC9BU,EAAMI,EAAIN,EAAOP,OAASW,EAAKX,OAC/B,MAAM,IAAIK,WAAW,kDAGzB,GAAIM,EAAKZ,MAAQS,EAAOT,OACpBY,EAAKX,OAASQ,EAAOR,QACrBU,EAAME,EAAIJ,EAAOT,MAAQY,EAAKZ,OAC9BW,EAAMG,EAAIL,EAAOR,OAASW,EAAKX,OAC/B,MAAM,IAAIK,WAAW,uDAMzB,IAHA,IAAMS,EAAUP,EAAOT,KACjBiB,EAAUP,EAAOV,KAEde,EAAI,EAAGA,EAAIF,EAAKX,OAAQa,IAG7B,IAFA,IAAMG,IAAcP,EAAMI,EAAIA,GAAKN,EAAOR,MAAQU,EAAMG,GAAKf,EACvDoB,IAAcP,EAAMG,EAAIA,GAAKL,EAAOT,MAAQW,EAAME,GAAKf,EACpDqB,EAAI,EAAGA,EAAIP,EAAKZ,MAAQF,EAAUqB,IACvCH,EAAQE,EAAYC,GAAKJ,EAAQE,EAAYE,GAGrD,OAAOV,CACX,CAIA,IAAaW,EAAS,WAClB,SAAAA,EAAYR,EAAMb,GAAMzC,OAAA8D,GACpBzB,EAAYtC,KAAMuD,EAAM,EAAGb,EAC/B,CAAC,OAAA7C,EAAAkE,EAAA,CAAA,CAAArD,IAAA,SAAAC,MAED,SAAO4C,IAxDX,SAAqBhB,EAAKyB,EAAmBvB,GAAU,IAA1BE,EAAKqB,EAALrB,MAAOC,EAAMoB,EAANpB,OAChC,GAAID,IAAUJ,EAAMI,OAASC,IAAWL,EAAMK,OAA9C,CAIA,IAAMqB,EAAW3B,EAAY,GAAI,CAACK,MAAAA,EAAOC,OAAAA,GAASH,GAElDS,EAAUX,EAAO0B,EAAU,CAACT,EAAG,EAAGC,EAAG,GAAI,CAACD,EAAG,EAAGC,EAAG,GAAI,CACnDd,MAAOuB,KAAKC,IAAI5B,EAAMI,MAAOA,GAC7BC,OAAQsB,KAAKC,IAAI5B,EAAMK,OAAQA,IAChCH,GAEHF,EAAMI,MAAQA,EACdJ,EAAMK,OAASA,EACfL,EAAMG,KAAOuB,EAASvB,IAXtB,CAYJ,CA0CQ0B,CAAYpE,KAAMuD,EAAM,EAC5B,GAAC,CAAA7C,IAAA,UAAAC,MAED,SAAQ+B,EAAM2B,GACNA,EACArE,KAAK0C,KAAK4B,IAAI5B,GACPA,aAAgBG,kBACvB7C,KAAK0C,KAAO,IAAII,WAAWJ,EAAKK,QAEhC/C,KAAK0C,KAAOA,CAEpB,GAAC,CAAAhC,IAAA,QAAAC,MAED,WACI,OAAO,IAAIoD,EAAU,CAACpB,MAAO3C,KAAK2C,MAAOC,OAAQ5C,KAAK4C,QAAS,IAAIE,WAAW9C,KAAK0C,MACvF,IAAC,CAAA,CAAAhC,IAAA,OAAAC,MAED,SAAYwC,EAAQC,EAAQC,EAAOC,EAAOC,GACtCL,EAAUC,EAAQC,EAAQC,EAAOC,EAAOC,EAAM,EAClD,IAAC,CAzBiB,GCnDP,SAAAgB,EAASC,GACtB,IACIC,EAAMlC,EADJmC,EAASC,OAAOC,iBAAmB,EAAI,MAAQ,GAG/CC,EAAcC,MAAK,GAAA1C,OAAIoC,GAAOpC,OAAGsC,EAAM,UACtCK,KAAK,SAAAC,GAAC,OAAIA,EAAEP,MAAM,GAClBM,KAAK,SAAAC,GAAC,OAAIP,EAAOO,CAAC,GAEnBC,EAAeH,MAAK,GAAA1C,OAAIoC,GAAOpC,OAAGsC,EAAM,SACvCK,KAAK,SAAAC,GAAC,OAAIA,EAAEE,MAAM,GAClBH,KAAK,SAAAC,GAGJ,OAFAzC,EAAQ,IAAI4C,OACNC,IAAMC,IAAIC,gBAAgBN,GACzB,IAAIO,QAAQ,SAACC,EAASC,GAC3BlD,EAAMmD,OAAS,WAAA,OAAMF,GAAS,EAC9BjD,EAAMoD,QAAU,WAAA,OAAMF,GAAQ,CAChC,EACF,GAEN,OAAOF,QAAQK,IAAI,CAACf,EAAaI,IAC9BF,KAAK,WACJ,IAAMc,EAjCZ,SAAsBC,GACpB,IAAMC,EAASpB,OAAOrE,SAASC,cAAc,UACvCyF,EAAUD,EAAOE,WAAW,MAClC,IAAKD,EACH,MAAM,IAAIE,MAAM,sCAKlB,OAHAH,EAAOpD,MAAQmD,EAAInD,MACnBoD,EAAOnD,OAASkD,EAAIlD,OACpBoD,EAAQG,UAAUL,EAAK,EAAG,EAAGA,EAAInD,MAAOmD,EAAIlD,QACrCoD,EAAQI,aAAa,EAAG,EAAGN,EAAInD,MAAOmD,EAAIlD,OACnD,CAuBwBwD,CAAa7D,GACzB8D,EAAS,CAAA,EAEf,IAAK,IAAMtE,KAAM0C,EAAM,CACrB,IAAA6B,EAA4E7B,EAAK1C,GAA1EY,EAAK2D,EAAL3D,MAAOC,EAAM0D,EAAN1D,OAAQY,EAAC8C,EAAD9C,EAAGC,EAAC6C,EAAD7C,EAAG8C,EAAGD,EAAHC,IAAKC,EAAUF,EAAVE,WAAYC,EAAQH,EAARG,SAAUC,EAAQJ,EAARI,SAAUC,EAAOL,EAAPK,QAC3DjE,EAAO,IAAIqB,EAAU,CAACpB,MAAAA,EAAOC,OAAAA,IACnCmB,EAAUM,KAAKwB,EAAWnD,EAAM,CAACc,EAAAA,EAAGC,EAAAA,GAAI,CAACD,EAAG,EAAGC,EAAG,GAAI,CAACd,MAAAA,EAAOC,OAAAA,IAC9DyD,EAAOtE,GAAM,CAACW,KAAAA,EAAM8D,WAAAA,EAAYD,IAAAA,EAAKE,SAAAA,EAAUC,SAAAA,EAAUC,QAAAA,EAC3D,CACA,OAAON,CACT,EACJ,gBCvCMO,EAAa,WAShB,OAAA/G,EARD,SAAA+G,EAAYC,GAAmB,IAAdC,EAAOC,UAAA/D,OAAA,QAAAgE,IAAAD,UAAA,GAAAA,UAAA,GAAG,CAAA,EAAE9G,OAAA2G,GAC3B,IACMK,EAAI9E,EAAAA,EAAA,CAAA,EADU,CAAEL,OAAAA,EAAQoF,QAAS,CAAA,IACLJ,GAClC9G,KAAK6G,IAAMA,EACX7G,KAAKkH,QAAUD,EAAKC,QACpBlH,KAAK8B,OAASmF,EAAKnF,OACnB9B,KAAKmH,aAAe,cACpBnH,KAAKoH,SAAQ,GAAAhF,OAAMpC,KAAKmH,aAAY,QACtC,EAAC,CAAA,CAAAzG,IAAA,YAAAC,MAED,WAAY,IAAAZ,EAAAC,KACVqH,OAAOC,KAAKtH,KAAKkH,SAASjG,QAAQ,SAACsG,GACjCxH,EAAK8G,IAAIW,aAASpF,OAAIrC,EAAKoH,aAAY,KAAA/E,OAAImF,GAAa,CACtD7F,KAAM,UACNgB,KAAM3C,EAAKmH,QAAQK,IAEvB,EACF,GAAC,CAAA7G,IAAA,YAAAC,MAED,WAAY,IAAAG,EAAAd,KACJyH,EAAeJ,OAAOC,KAAKtH,KAAKkH,SAChCpF,EAAS9B,KAAK8B,OACpB9B,KAAK8B,OAASA,EAAOE,OAAO,SAAC0F,GAC3B,OAAOD,EAAaE,SAASD,EAAM,gBACrC,GACA1H,KAAK8B,OAAOb,QAAQ,SAACyG,GACnB5G,EAAK+F,IAAIe,SAAQzF,EAAAA,EAAA,CACf0F,OAAM,GAAAzF,OAAKtB,EAAKqG,aAAY,KAAA/E,OAAIsF,EAAM,kBACnCA,GAAK,GAAA,CACR,eAAgB,KAEpB,EACF,GAAC,CAAAhH,IAAA,SAAAC,MAED,WAAS,IAAAmH,EAAA9H,KACPA,KAAK8B,OAAOb,QAAQ,SAACyG,GACnBI,EAAKjB,IAAIkB,YAAYL,EAAM3F,GAC7B,GACAsF,OAAOC,KAAKtH,KAAKkH,SAASjG,QAAQ,SAACsG,GACjCO,EAAKjB,IAAImB,gBAAY5F,OAAI0F,EAAKX,aAAY,KAAA/E,OAAImF,GAChD,EACF,IAAC,CA1CgB,GA6CbU,EAAgB,WAYnB,OAAApI,EAXD,SAAAoI,EAAYpB,GAAmB,IAAdC,EAAOC,UAAA/D,OAAA,QAAAgE,IAAAD,UAAA,GAAAA,UAAA,GAAG,CAAA,EAAE9G,OAAAgI,GAC3B,IAAMC,EAAc,CAAEC,IAAK,iCAAkCrG,OAAAA,GACvDmF,EAAI9E,EAAAA,EAAA,CAAA,EAAQ+F,GAAgBpB,GAClC,GAAIG,EAAKkB,MAAQD,EAAYC,MAAQlB,EAAKmB,OACxC,KAAM,8FAERpI,KAAK6G,IAAMA,EACX7G,KAAKmI,IAAMlB,EAAKkB,IAChBnI,KAAKoI,OAASnB,EAAKmB,OACnBpI,KAAK8B,OAASmF,EAAKnF,OACnB9B,KAAKoH,SAAW,aAClB,EAAC,CAAA,CAAA1G,IAAA,YAAAC,MAED,WACE,IAAM0H,EAAcrI,KAAKoI,OAAM,QAAAhG,OAAWpC,KAAKoI,QAAW,GAC1DpI,KAAK6G,IAAIW,UAAUxH,KAAKoH,SAAU,CAChC1F,KAAM,SACNyG,IAAG,GAAA/F,OAAKpC,KAAKmI,KAAG/F,OAAGiG,IAEvB,GAAC,CAAA3H,IAAA,YAAAC,MAED,WAAY,IAAA2H,EAAAtI,KACVA,KAAK8B,OAAOb,QAAQ,SAACyG,GACnBY,EAAKzB,IAAIe,SAAQzF,EAAA,CACf0F,OAAQS,EAAKlB,UACVM,GAEP,EACF,GAAC,CAAAhH,IAAA,SAAAC,MAED,WAAS,IAAA4H,EAAAvI,KACPA,KAAK8B,OAAOb,QAAQ,SAACyG,GACnBa,EAAK1B,IAAIkB,YAAYL,EAAM3F,GAC7B,GACA/B,KAAK6G,IAAImB,aAAahI,KAAKoH,SAC7B,IAAC,CApCmB,GAsDDoB,EAAW,WAuB9B,OAAA3I,EAtBA,SAAA2I,EAAY3B,GAAmB,IAAA4B,EAAAzI,KAAd8G,EAAOC,UAAA/D,OAAA,QAAAgE,IAAAD,UAAA,GAAAA,UAAA,GAAG,CAAA,EAAE9G,OAAAuI,GAC3B,IAAME,EAAc5B,EAAQI,QAAUN,EAAgBqB,EAEhDhB,EAAI9E,EAAAA,EAAA,CAAA,EADU,CAAEwG,SAAS,IACG7B,GAClC9G,KAAK6H,OAAS,IAAIa,EAAY7B,EAAKC,GACnC9G,KAAK6G,IAAMA,EACX7G,KAAKgB,OAAS,GACdhB,KAAKkB,MAAQ,IACblB,KAAK4I,OAAS,CAAA,EACd5I,KAAK6I,YAActE,EAEfvE,KAAK6G,IAAIiC,iBACX9I,KAAK+I,QACL/I,KAAKgJ,kBAAkB/B,EAAK0B,UAE5B3I,KAAK6G,IAAIoC,KAAK,OAAQ,WACpBR,EAAKM,QACLN,EAAKO,kBAAkB/B,EAAK0B,QAC9B,EAEJ,EAEA,CAAA,CAAAjI,IAAA,SAAAC,MAGA,SAAOuI,GACAA,GACHlJ,KAAK6H,OAAOjH,SAEdZ,KAAKmJ,sBAAsBC,QAC3BpJ,KAAK6G,IAAIhG,IAAI,OAAQb,KAAKmJ,uBAC1BnJ,KAAK6G,IAAIhG,IAAI,OAAQb,KAAKmJ,uBAC1BnJ,KAAK6G,IAAIhG,IAAI,OAAQb,KAAKmJ,uBACtBnJ,KAAKqJ,UACPrJ,KAAKsJ,UAET,GAEA,CAAA5I,IAAA,KAAAC,MAKA,SAAG4I,EAAMC,GACFxJ,KAAK4I,OAAOW,KACfvJ,KAAK4I,OAAOW,GAAQ,IAEtBvJ,KAAK4I,OAAOW,GAAME,KAAKD,EACzB,GAEA,CAAA9I,IAAA,MAAAC,MAKA,SAAI4I,EAAMC,GACHxJ,KAAK4I,OAAOW,KACfvJ,KAAK4I,OAAOW,GAAQ,IAEtBvJ,KAAK4I,OAAOW,GAAQvJ,KAAK4I,OAAOW,GAAMvH,OAAO,SAAA0H,GAAE,OAAIA,IAAOF,CAAE,EAC9D,GAEA,CAAA9I,IAAA,QAAAC,MAIA,WAEE,OADAX,KAAKqJ,SAAW,IAAIzJ,EAAaI,MAC1BA,KAAKqJ,SAAShJ,GACvB,GAEA,CAAAK,IAAA,WAAAC,MAIA,WACEX,KAAKqJ,SAASM,UACd3J,KAAKqJ,SAAW,IAClB,GAEA,CAAA3I,IAAA,WAAAC,MAKA,SAASO,GACPlB,KAAKkB,MAAQA,EACblB,KAAK4J,iBACL5J,KAAK6J,kBACP,GAEA,CAAAnJ,IAAA,cAAAC,MAMA,SAAYO,GACV4I,QAAQC,IAAI,sEACZ/J,KAAKwB,SAASN,EAChB,GAEA,CAAAR,IAAA,aAAAC,MAOA,SAAW6D,GAAuB,IAAAwF,EAAAhK,KAC1BiH,EAAI9E,EAAA,CAAK8H,QAAQ,GADElD,UAAA/D,OAAA,QAAAgE,IAAAD,UAAA,GAAAA,UAAA,GAAG,CAAA,GAE5B,OAAO/G,KAAK6I,YAAYrE,GACrBO,KAAK,SAACmF,GACL,IAAK,IAAMnI,KAAMmI,EAAQ,CACvB,IAAAC,EAA6BD,EAAOnI,GAA5BW,EAAIyH,EAAJzH,KAASoE,EAAOsD,EAAAD,EAAAE,GACnBL,EAAKnD,IAAIyD,SAASvI,GAEZkF,EAAKgD,QACdD,EAAKnD,IAAI0D,YAAYxI,EAAIW,GAFzBsH,EAAKnD,IAAI2D,SAASzI,EAAIW,EAAMoE,EAIhC,CACA,OAAOoD,CACT,EACJ,GAEA,CAAAxJ,IAAA,oBAAAC,MAIA,SAAkB8J,GACZzK,KAAK6G,IAAI6D,SAAS,gBACpB1K,KAAK6G,IAAI8D,kBAAkB,cAAe,aAAcF,EAAU,UAAY,OAElF,GAAC,CAAA/J,IAAA,QAAAC,MAED,WAAQ,IAAAiK,EAAA5K,KACNA,KAAK6H,OAAOL,YACZxH,KAAK6H,OAAOgD,YACZ7K,KAAK4J,iBACL5J,KAAKmJ,sBCtPM,SAAkB2B,EAAWC,EAAO,IAAKjE,EAAU,CAAA,GACjE,GAAyB,mBAAdgE,EACV,MAAM,IAAIE,UAAU,+DAA+DF,QAGpF,GAAIC,EAAO,EACV,MAAM,IAAI9H,WAAW,gCAGtB,GAAuB,kBAAZ6D,EACV,MAAM,IAAIkE,UAAU,8FAGrB,MAAMC,UAACA,GAAanE,EAEpB,IAAIoE,EACAC,EACAC,EACAC,EACAhF,EAEJ,SAASiF,IACR,MAAMC,EAAcL,EACdM,EAAgBL,EAItB,OAHAD,OAAgBlE,EAChBmE,OAAkBnE,EAClBX,EAASyE,EAAUW,MAAMF,EAAaC,GAC/BnF,CACR,CAEA,SAASqF,IACR,MAAMC,EAAOC,KAAKC,MAAQR,EAEtBM,EAAOZ,GAAQY,GAAQ,EAC1BP,EAAYU,WAAWJ,EAAOX,EAAOY,IAErCP,OAAYpE,EAEPiE,IACJ5E,EAASiF,KAGZ,CAEA,MAAMS,EAAY,YAAaC,GAC9B,GACCd,GACGlL,OAASkL,GACT7D,OAAO4E,eAAejM,QAAUqH,OAAO4E,eAAef,GAEzD,MAAM,IAAIhF,MAAM,0EAGjBgF,EAAgBlL,KAChBmL,EAAkBa,EAClBX,EAAYO,KAAKC,MAEjB,MAAMK,EAAUjB,IAAcG,EAM9B,GAJKA,IACJA,EAAYU,WAAWJ,EAAOX,IAG3BmB,EAEH,OADA7F,EAASiF,IACFjF,CAIT,EAiCA,OA/BAgB,OAAO8E,eAAeJ,EAAW,YAAa,CAC7CK,IAAGA,SACmBpF,IAAdoE,IAITW,EAAU3C,MAAQ,KACZgC,IAILiB,aAAajB,GACbA,OAAYpE,EACZkE,OAAgBlE,EAChBmE,OAAkBnE,IAGnB+E,EAAUO,MAAQ,KACZlB,GAILW,EAAUQ,WAGXR,EAAUQ,QAAU,KACnBlG,EAASiF,IAETS,EAAU3C,SAGJ2C,CACR,CD+IiCS,CAASxM,KAAKyM,cAAcC,KAAK1M,MAAO,KAErEA,KAAK6G,IAAIzG,GAAG,OAAQJ,KAAKmJ,uBACzBnJ,KAAK6G,IAAIzG,GAAG,OAAQJ,KAAKmJ,uBACzBnJ,KAAK6G,IAAIzG,GAAG,OAAQJ,KAAKmJ,uBACzBnJ,KAAK6G,IAAIzG,GAAG,SAAU,WACpBwK,EAAKhK,QAAO,EACd,EACF,GAAC,CAAAF,IAAA,iBAAAC,MAED,WAAiB,IAAAgM,EAAA3M,KACfA,KAAK6H,OAAO/F,OACXE,OAAO,SAAA0F,GAAK,MAAmB,YAAfA,EAAMhG,IAAkB,GACxCT,QAAQ,SAACyG,GACRiF,EAAK9F,IAAI+F,UAAUlF,EAAM3F,GAAE,GAAAK,OAAAyK,EAAOnF,EAAM1F,QAAU,CAAC,QAAM,CAAE,CAAC,KAAM,QAAS2K,EAAKzL,SAClF,EACF,GAAC,CAAAR,IAAA,4BAAAC,MAED,WACOX,KAAKgB,OAAO2G,SAAS3H,KAAKkB,QAC7BlB,KAAKwB,SAAS,IAElB,GAAC,CAAAd,IAAA,gBAAAC,MAED,WACE,GAAIX,KAAK6G,IAAIiG,eAAe9M,KAAK6H,OAAOT,UAAW,CACjD,IACMpG,EEjRG,SAAuB+L,GAEpC,IADA,IAAM/L,EAAS,GACN8C,EAAI,EAAGA,EAAIiJ,EAAS/J,OAAQc,IAAK,CACxC,IAAMkJ,EAAUD,EAASjJ,GACzB,GAAiC,UAA7BkJ,EAAQC,WAAU,MAAtB,CAGA,IAAM/L,EAAQ8L,EAAQC,WAAW/L,MAC5BF,EAAO2G,SAASzG,IACnBF,EAAOyI,KAAKvI,EAHd,CAKF,CACA,OAAOF,EAAOkM,KAAK,SAACC,EAAGC,GAAC,OAAKD,EAAIC,CAAC,GAAEC,SACtC,CFoQqBC,CADEtN,KAAK6G,IAAI0G,oBAAoBvN,KAAK6H,OAAOT,SAAU,CAAEoG,YAAa,WGhR1E,SAAoBC,EAAQC,GAC1C,GAAID,IAAWC,EACd,OAAO,EAGR,MAAM1K,OAACA,GAAUyK,EAEjB,GAAIzK,IAAW0K,EAAO1K,OACrB,OAAO,EAGR,IAAK,IAAI2K,EAAQ,EAAGA,EAAQ3K,EAAQ2K,IACnC,GAAIF,EAAOE,KAAWD,EAAOC,GAC5B,OAAO,EAIT,OAAO,CACR,EHgQWC,CAAW5M,EAAQhB,KAAKgB,UAC3BhB,KAAKgB,OAASA,EACdhB,KAAK6N,oBACL7N,KAAK8N,4BAET,CACF,GAAC,CAAApN,IAAA,oBAAAC,MAED,WACEX,KAAK+N,WAAW,eAAgB/N,KAAKgB,OACvC,GAAC,CAAAN,IAAA,mBAAAC,MAED,WACEX,KAAK+N,WAAW,cAAe/N,KAAKkB,MACtC,GAAC,CAAAR,IAAA,aAAAC,MAED,SAAWqN,GAAoB,IAAA,IAAAC,EAAAlH,UAAA/D,OAANkL,MAAIC,MAAAF,EAAA,EAAAA,OAAAG,EAAA,EAAAA,EAAAH,EAAAG,IAAJF,EAAIE,EAAA,GAAArH,UAAAqH,IAC1BpO,KAAK4I,OAAOoF,IAAc,IAAI/M,QAAQ,SAAAuI,GAAE,OAAIA,EAAEiC,WAAA,EAAIyC,EAAK,EAC1D,IAAC,CA1L6B","x_google_ignoreList":[5,7]}